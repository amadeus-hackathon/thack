/*
 * Aria Templates 1.4.12 - 07 Nov 2013
 *
 * Copyright 2009-2013 Amadeus s.a.s.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *    http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
//***MULTI-PART
//*******************
//LOGICAL-PATH:aria/utils/dragdrop/IDrag.js
//*******************
Aria.interfaceDefinition({$classpath:"aria.utils.dragdrop.IDrag",$interface:{start:{$type:"Function"},move:{$type:"Function"},end:{$type:"Function"}},$events:{dragstart:"",move:"",dragend:"",beforeresize:"",resize:"",resizeend:""}});
//*******************
//LOGICAL-PATH:aria/utils/dragdrop/Drag.js
//*******************
(function(){function t(t,e,i){t&&t.setAttribute(e,i)}function e(t,e){t&&t.removeAttribute(e)}var i=0;Aria.classDefinition({$classpath:"aria.utils.dragdrop.Drag",$dependencies:["aria.utils.Dom","aria.utils.Mouse","aria.utils.Type"],$implements:["aria.utils.dragdrop.IDrag"],$statics:{INVALID_ATTRIBUTE:"Invalid attribute '%1' in '%2'"},$constructor:function(e,i){i=i||{},this.id=null,this.element=null;var r=aria.utils.Type;r.isString(e)?this.id=e:r.isHTMLElement(e)?(this.element=e,this.id=this.element.id):(this.$logError(this.INVALID_ATTRIBUTE,["id","constructor"]),this.start=Aria.empty,this.move=Aria.empty,this.end=Aria.empty),this.params=i,this.handle=i.handle,this.cursor=i.cursor,this.originalCursor=null,this.proxy=null,this.posX=null,this.posY=null,this._boundary=null,this._horizontal=i.axis&&"x"==i.axis,this._vertical=i.axis&&"y"==i.axis,this._elementInitialPosition=null,this._movableInitialGeometry=null,this._movableGeometry=null,this._baseMovableOffset=null,this.listenerId=aria.utils.Mouse.listen("drag",this),t(this.getDraggable(!0),aria.utils.Mouse.DRAGGABLE_ATTRIBUTE,this.listenerId),this.getMovable(!1)},$destructor:function(){var t=this.getDraggable();t&&(e(t,aria.utils.Mouse.DRAGGABLE_ATTRIBUTE),t.style.cursor=this.originalCursor,t=null),this.proxy&&this.proxy.overlay&&this.proxy.$dispose(),this.element=null,this.handle=null,this.cursor=null,this.proxy=null,aria.utils.Mouse.stopListen("drag",this)},$prototype:{getDraggable:function(t){var e,i=this.handle,r=this.cursor;if(i){var s=aria.utils.Type;s.isString(i)&&(i=aria.utils.Dom.getElementById(i)),s.isHTMLElement(i)?(this.handle=i,e=i):t===!0&&this.$logError(this.INVALID_ATTRIBUTE,["handle","params"])}else e=this.getElement(t);return e?(r&&(null==this.originalCursor&&(this.originalCursor=e.style.cursor),e.style.cursor=r),e):void 0},getElement:function(t){var e=this.element;if(!e){if(e=aria.utils.Dom.getElementById(this.id),!e)return t===!0&&this.$logError(this.INVALID_ATTRIBUTE,["id","constructor"]),void 0;this.element=e}return e},_setElementStyle:function(t){var e=aria.utils.Dom.getOffset(t),i={left:e.left,top:e.top};this._elementInitialPosition=i;var r=t.style;r.position="absolute",r.left=i.left+"px",r.top=i.top+"px"},getMovable:function(t){var e=this.proxy;if(e)return e.overlay;var i=this.params,r=i.proxy;if(r){var s="aria.utils.overlay."+r.type;return Aria.load({classes:[s],oncomplete:t===!1?null:{fn:this._createProxy,scope:this,args:{classpath:s,cfg:r.cfg}},onerror:{fn:function(){this.$logError(this.INVALID_ATTRIBUTE,["proxy","params"])},scope:this,override:!0}}),t===!1||this.proxy||(this.proxy={}),this.proxy?this.proxy.overlay:this.proxy}return this.getElement()},_createProxy:function(t){var e=Aria.getClassRef(t.classpath);try{var r=t.cfg||{};r.id=this.id||"proxy_"+i,i++,this.proxy=new e(this.getElement(),r)}catch(s){this.$logError(this.INVALID_ATTRIBUTE,["proxy","params"])}},start:function(t){this.posX=t.x,this.posY=t.y;var e,i=this.getElement(!0),r=aria.utils.Dom;i.onselectstart=Aria.returnFalse,this._setElementStyle(i),this._setBoundary();var s=this.getMovable();if(s){s.onselectstart=Aria.returnFalse,s.offsetTop<i.offsetTop&&(s.style.top=i.offsetTop+"px"),this._movableInitialGeometry=aria.utils.Dom.getGeometry(s),this._movableGeometry=aria.utils.Json.copy(this._movableInitialGeometry),e=r._getDocumentScroll().scrollTop,this._movableGeometry.y+=e>0?e:0;var a=aria.utils.Dom.getOffset(s);this._baseMovableOffset={left:this._movableGeometry.x-a.left,top:this._movableGeometry.y-a.top},this.$raiseEvent("dragstart")}},move:function(t){var e=this.getMovable(),i=aria.utils.Dom;if(e&&e.style){var r=this._vertical?0:t.clientX-this.posX,s=this._horizontal?0:t.clientY-this.posY,a=aria.utils.Json.copy(this._movableGeometry);a.x+=r,a.y+=s;var n=this._boundary?i.fitInside(a,this._boundary):{top:a.y,left:a.x};e.style.top=n.top-this._baseMovableOffset.top+"px",e.style.left=n.left-this._baseMovableOffset.left+"px",a.y=n.top,a.x=n.left,this.posY+=a.y-this._movableGeometry.y,this.posX+=a.x-this._movableGeometry.x,this._movableGeometry=a,this.$raiseEvent("move")}},end:function(){var t,e=this.getElement(),i=aria.utils.Dom;t=i._getDocumentScroll().scrollTop,e.onselectstart=Aria.returnTrue,this.proxy&&this.proxy.overlay&&(this._movableInitialGeometry.y+=t>0?t:0,e.style.top=this._elementInitialPosition.top+this._movableGeometry.y-this._movableInitialGeometry.y+"px",e.style.left=this._elementInitialPosition.left+this._movableGeometry.x-this._movableInitialGeometry.x+"px",this.proxy.$dispose(),this.proxy=null),this.$raiseEvent("dragend")},_setBoundary:function(){var t=this.params.constrainTo,e=aria.utils.Dom;return t&&t!==e.VIEWPORT?(aria.utils.Type.isString(t)&&(t=e.getElementById(t)),t?(this._boundary=aria.utils.Dom.getGeometry(t),void 0):(this._boundary=null,this.$logError(this.INVALID_ATTRIBUTE,["constrainTo","params"]),void 0)):(this._boundary=t,void 0)}}})})();
//*******************
//LOGICAL-PATH:aria/utils/dragdrop/DragDropBean.js
//*******************
Aria.beanDefinitions({$package:"aria.utils.dragdrop.DragDropBean",$namespaces:{json:"aria.core.JsonTypes"},$beans:{DragCfg:{$type:"json:Object",$properties:{handle:{$type:"json:MultiTypes",$contentTypes:[{$type:"json:String"},{$type:"json:ObjectRef"}]},cursor:{$type:"json:String"},proxy:{$type:"ProxyCfg"},constrainTo:{$type:"json:MultiTypes",$contentTypes:[{$type:"json:String"},{$type:"json:String"},{$type:"json:ObjectRef"}]},axis:{$type:"json:Enum",$enumValues:["x","y"]}}},ProxyCfg:{$type:"json:Object",$properties:{type:{$type:"json:Enum",$enumValues:["Overlay","CloneOverlay"]},cfg:{$type:"json:ObjectRef"}}}}});
//*******************
//LOGICAL-PATH:aria/utils/resize/Resize.js
//*******************
Aria.classDefinition({$classpath:"aria.utils.resize.Resize",$extends:"aria.utils.dragdrop.Drag",$dependencies:["aria.utils.Dom","aria.utils.String","aria.utils.Json"],$constructor:function(t,e){e=e||{};var i={type:"Overlay"},r=t,s=this;this.minHeight=100,this.minWidth=100,this.$Drag.constructor.call(s,r,{handle:e.handle,cursor:e.cursor,proxy:i,axis:e.axis,constrainTo:aria.utils.Dom.VIEWPORT})},$destructor:function(){this.$Drag.$destructor.call(this),this.minHeight=null,this.minWidth=null},$prototype:{start:function(t){this.posX=t.x,this.posY=t.y;var e,i=this.getElement(!0),r=Aria.$window.document;i.onselectstart=Aria.returnFalse,r.onselectstart=Aria.returnFalse,this._setElementStyle(i),this._setBoundary(),e=this.getMovable(),e&&(e.onselectstart=Aria.returnFalse,this._movableInitialGeometry=aria.utils.Dom.getGeometry(e),this._movableGeometry=aria.utils.Json.copy(this._movableInitialGeometry),this._baseMovableOffset={left:this._movableGeometry.x-e.offsetLeft,top:this._movableGeometry.y-e.offsetTop,height:this._movableGeometry.height-e.offsetHeight,width:this._movableGeometry.width-e.offsetWidth},this.$raiseEvent("beforeresize"))},move:function(t){var e=this.getMovable();if(e&&e.style){var i,r,s=this._vertical?0:t.clientX-this.posX,a=this._horizontal?0:t.clientY-this.posY,n=aria.utils.Json.copy(this._movableGeometry);n=this._resizeWitHandlers(n,this.cursor,s,a);var o=/sw-resize|nw-resize|w-resize/.test(this.cursor),l=/nw-resize|ne-resize|n-resize/.test(this.cursor),c=n.width<this.minWidth,h=n.height<this.minHeight;c&&(n.width=this.minWidth),h&&(n.height=this.minHeight),i=this._movableGeometry.x+this._movableGeometry.width,r=this._movableGeometry.y+this._movableGeometry.height,c&&o&&(n.x=i-this.minWidth),h&&l&&(n.y=r-this.minHeight),e.style.cursor=this.cursor,e.style.top=n.y-this._baseMovableOffset.top+"px",e.style.left=n.x-this._baseMovableOffset.left+"px",e.style.height=n.height-this._baseMovableOffset.height+"px",e.style.width=n.width-this._baseMovableOffset.width+"px",this._movableGeometry=n,this.$raiseEvent("resize")}},end:function(){var t=this.getElement();t.onselectstart=Aria.returnTrue,this.proxy&&this.proxy.overlay&&(t.style.top=this._elementInitialPosition.top+this._movableGeometry.y-this._movableInitialGeometry.y+"px",t.style.left=this._elementInitialPosition.left+this._movableGeometry.x-this._movableInitialGeometry.x+"px",t.style.height=this._elementInitialPosition.height+this._movableGeometry.height-this._movableInitialGeometry.height+"px",t.style.width=this._elementInitialPosition.width+this._movableGeometry.width-this._movableInitialGeometry.width+"px",this.proxy.$dispose(),this.proxy=null),this.$raiseEvent("resizeend")},_resizeWitHandlers:function(t,e,i,r){var t=aria.utils.Json.copy(t),s=aria.utils.String.trim;e=s(e);var a=t.width>=this.minWidth?i:0,n=t.height>=this.minHeight?r:0;switch(e){case"n-resize":t.y+=n,t.height-=n,t=this._fitResizeBoundary(t),this.posY+=t.y-this._movableGeometry.y;break;case"ne-resize":t.y+=n,t.height-=n,t.width+=a,t=this._fitResizeBoundary(t),this.posX+=a,this.posY+=t.y-this._movableGeometry.y;break;case"nw-resize":t.x+=a,t.y+=n,t.height-=n,t.width-=a,t=this._fitResizeBoundary(t),this.posX+=t.x-this._movableGeometry.x,this.posY+=t.y-this._movableGeometry.y;break;case"s-resize":t.height+=n,t=this._fitResizeBoundary(t),this.posY+=n;break;case"se-resize":t.height+=n,t.width+=a,t=this._fitResizeBoundary(t),this.posY+=n,this.posX+=a;break;case"sw-resize":t.x+=a,t.height+=n,t.width-=a,t=this._fitResizeBoundary(t),this.posY+=n,this.posX+=t.x-this._movableGeometry.x;break;case"e-resize":t.width+=a,t=this._fitResizeBoundary(t),this.posX+=a;break;case"w-resize":t.x+=a,t.width-=a,t=this._fitResizeBoundary(t),this.posX+=t.x-this._movableGeometry.x}return t},_fitResizeBoundary:function(t){var e=aria.utils.Dom,i=this._boundary?e.fitInside(t,this._boundary):{top:t.y,left:t.x};return t.x=i.left,t.y=i.top,t},_setElementStyle:function(t){var e=t.style,i={left:t.offsetLeft,top:t.offsetTop,height:t.offsetHeight,width:t.offsetWidth};this._elementInitialPosition=i,e.position="absolute",e.left=i.left+"px",e.top=i.top+"px",e.height=i.height+"px",e.width=i.width+"px"}}});